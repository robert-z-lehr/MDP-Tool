<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MDP Builder — Decision Analytics Lens</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<header>
  <h1>MDP Builder</h1>
  <p>Paste a natural-language problem. This tool drafts MDP elements, lets you edit them, and then runs a finite-horizon dynamic program. <strong>Value function is an output</strong>, not an input.</p>
</header>

<main>
  <section class="card">
    <h2>1) Describe the problem</h2>
    <textarea id="nlpInput" rows="7" placeholder="Example: A delivery robot navigates 3 zones (A,B,C). Each hour, it may wait, charge, or deliver... Costs: battery depletion, delay penalties... Constraints: energy ≤ 100... Horizon: 4 stages..."></textarea>
    <div class="row">
      <label>Horizon T (stages): <input id="horizon" type="number" min="1" value="4"></label>
      <label>Discount γ (0–1): <input id="gamma" type="number" min="0" max="0.9999" step="0.01" value="0.95"></label>
    </div>
    <button id="parseBtn">Draft MDP from text</button>
    <button id="loadExampleBtn" class="ghost">Load example</button>
  </section>

  <section class="card grid-2">
    <div>
      <h2>2) Edit MDP Inputs</h2>
      <details open>
        <summary>States S</summary>
        <textarea id="states" rows="4" placeholder="Comma-separated, e.g., A,B,C"></textarea>
      </details>
      <details>
        <summary>Actions A</summary>
        <textarea id="actions" rows="4" placeholder="Comma-separated, e.g., wait,charge,deliver"></textarea>
      </details>
      <details>
        <summary>Constraints</summary>
        <textarea id="constraints" rows="3" placeholder="Key constraints, e.g., energy<=100; no_deliver_in_state=C"></textarea>
      </details>
      <details>
        <summary>Salvage Function V_T(s)</summary>
        <textarea id="salvage" rows="4" placeholder="JSON object mapping state→value, e.g., {&quot;A&quot;:0,&quot;B&quot;:0,&quot;C&quot;:0}"></textarea>
      </details>
      <details>
        <summary>Cost Matrix c_t(s,a)</summary>
        <p>Provide a default cost per (state,action). Use JSON: { "t": { "s": { "a": cost } } } or a single layer { "s": { "a": cost } } to reuse for all t.</p>
        <textarea id="costs" rows="8" placeholder='{"A":{"wait":1,"charge":3,"deliver":2},"B":{"wait":1,"charge":3,"deliver":2},"C":{"wait":1,"charge":3,"deliver":4}}'></textarea>
      </details>
      <details>
        <summary>Transition Matrices P_t(s'|s,a)</summary>
        <p>JSON: { "t": { "s": { "a": { "s'": prob, ... } } } } or a single time-invariant object reused across t.</p>
        <textarea id="transitions" rows="10" placeholder='{"A":{"wait":{"A":0.8,"B":0.2},"charge":{"A":0.9,"B":0.1},"deliver":{"B":0.7,"C":0.3}}, "B":{"wait":{"B":0.8,"C":0.2},"charge":{"A":0.4,"B":0.6},"deliver":{"C":0.8,"B":0.2}}, "C":{"wait":{"C":1.0},"charge":{"B":1.0},"deliver":{"C":1.0}}}'></textarea>
      </details>
    </div>

    <div>
      <h2>3) Results (Outputs)</h2>
      <div class="row">
        <button id="solveBtn">Solve DP</button>
        <button id="exportBtn" class="ghost">Export JSON</button>
      </div>
      <details open>
        <summary>Value Function V_t(s)</summary>
        <pre id="valueFn">(solve to see results)</pre>
      </details>
      <details>
        <summary>Optimal Policy π_t(s)</summary>
        <pre id="policy">(solve to see results)</pre>
      </details>
      <details>
        <summary>Diagnostics</summary>
        <pre id="diag"></pre>
      </details>
    </div>
  </section>

  <section class="card">
    <h2>Notes</h2>
    <ul>
      <li>Natural-language parser is heuristic. It proposes candidates; you should edit.</li>
      <li>All inputs are client-side. No server, no external libraries.</li>
      <li>Value function is computed backward from stage T using your salvage values.</li>
    </ul>
  </section>
</main>

<footer>
  <small>© 2025 — Front-end only demo for GitHub Pages.</small>
</footer>

<script src="app.js"></script>
</body>
</html>
